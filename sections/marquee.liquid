{{ 'marquee.css' | asset_url | stylesheet_tag }}

{% liquid
  assign background = section.settings.color_scheme.settings.background
  assign background_gradient = section.settings.color_scheme.settings.background_gradient
  assign text_color = section.settings.color_scheme.settings.text
  assign solid_button_background = section.settings.color_scheme.settings.button
  assign solid_button_label = section.settings.color_scheme.settings.button_label
  assign outline_button = section.settings.color_scheme.settings.secondary_button_label
  assign shadow = section.settings.color_scheme.settings.shadow
%}

{% style %}
  .section-{{ section.id }}-padding {

     padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
        padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
  @media screen and (min-width: 750px) {
        .section-{{ section.id }}-padding {
          padding-top: {{ section.settings.padding_top }}px;
          padding-bottom: {{ section.settings.padding_bottom }}px;
        }
      }

{% endstyle %}

<section class="marquee-section section-{{ section.id }}-padding" id="cc-marquee-text-logo">
    {% if section.blocks.size > 0 %}
  <div class="marquee-container color-{{ section.settings.color_scheme }}">
      <div class="marquee-scroller marquee-infinte{{ section.id }} animations {{ section.settings.animation_type }}">
        {% for block in section.blocks %}
          {% if block.settings.content_type == 'text' %}
            {% if block.settings.text != blank %}
              <div class="marquee-item marquee-text">
                <span style="font-size: {{ block.settings.text_size }}px;">
                  {{ block.settings.text }}
                </span>
              </div>
            {% endif %}
          {% elsif block.settings.content_type == 'logo' %}
            <div class="marquee-item marquee-logo">
              <a href="{{ block.settings.logo_link | default: '#' }}">
                {% if block.settings.logo_image != blank %}
                  {{ block.settings.logo_image | img_url: '' | img_tag: loading: 'lazy' }}
                {% else %}
                  {{ 'image' | placeholder_svg_tag }}
                {% endif %}
              </a>
            </div>
          {% elsif block.settings.content_type == 'both' %}
            <div class="marquee-item marquee-both">
              {% if block.settings.logo_image %}
                {% if block.settings.logo_image != blank %}
                  <div class="marquee-logo">
                    <a href="{{ block.settings.logo_link | default: '#' }}">
                      {{ block.settings.logo_image | img_url: '' | img_tag: loading: 'lazy' }}
                    </a>
                  </div>
                {% endif %}
              {% elsif block.settings.icon %}
                <span class="tab-icon" style="font-size: {{ block.settings.text_size }}px;">
                  {% render 'marquee-icon', icon: block.settings.icon %}
                </span>
              {% endif %}
              {% if block.settings.text != blank %}
                <div class="marquee-text">
                  <span style="font-size: {{ block.settings.text_size }}px;">
                    {{ block.settings.text }}
                  </span>
                </div>
              {% endif %}
            </div>
          {% endif %}
        {% endfor %}
      </div>
  </div>
    {% endif %}
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery.Marquee/1.6.0/jquery.marquee.min.js" defer="defer"></script>
<script src="{{ 'jquery.min.js' | asset_url }}"></script>

{% schema %}
{
  "name": "t:sections.marquee_section.name",
  "settings": [
        {
      "type": "header",
      "content": "t:sections.marquee_section.settings.section_header.content"
      },
        {
      "type": "select",
      "id": "animation_type",
      "label": "t:sections.marquee_section.settings.animation_type.label",
      "options": [
        { "value": "fade-in", "label": "t:sections.marquee_section.settings.animation_type.option_1.label" },
        { "value": "slide-up", "label": "t:sections.marquee_section.settings.animation_type.option_2.label" },
        { "value": "slide-down", "label": "t:sections.marquee_section.settings.animation_type.option_3.label" },
        { "value": "zoom-in", "label": "t:sections.marquee_section.settings.animation_type.option_4.label" },
        { "value": "bounce-in","label": "t:sections.marquee_section.settings.animation_type.option_5.label"},
        {"value": "flip-in","label": "t:sections.marquee_section.settings.animation_type.option_6.label"},
        { "value": "fade-in-up","label": "t:sections.marquee_section.settings.animation_type.option_7.label"}

      ],
      "default": "fade-in"
    },
    {
      "type": "select",
      "id": "scroll_speed",
      "label": "t:sections.marquee_section.settings.scroll_speed.label",
      "options": [
        {
          "value": "100000",
          "label": "t:sections.marquee_section.settings.scroll_speed.option_1.label"
        },
        {
          "value": "50000",
          "label": "t:sections.marquee_section.settings.scroll_speed.option_2.label"
        },
        {
          "value": "30000",
          "label": "t:sections.marquee_section.settings.scroll_speed.option_3.label"
        },
        {
          "value": "15000",
          "label": "t:sections.marquee_section.settings.scroll_speed.option_4.label"
        },
        {
          "value": "8000",
          "label": "t:sections.marquee_section.settings.scroll_speed.option_5.label"
        }
      ],
      "default": "30000"
    },
    {
      "type": "select",
      "id": "scroll_direction",
      "label": "t:sections.marquee_section.settings.scroll_direction.label",
      "options": [
        {
          "value": "left",
          "label": "t:sections.marquee_section.settings.scroll_direction.option_1.label"
        },
        {
          "value": "right",
          "label": "t:sections.marquee_section.settings.scroll_direction.option_2.label"
        }
      ],
      "default": "left"
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "label": "t:sections.marquee_section.settings.pause_on_hover.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:sections.marquee_section.settings.section_colors.label"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    },
  ],
  "blocks": [
    {
      "type": "content",
      "name": "t:sections.marquee_section.blocks.text_logo.name",
      "settings": [
        {
          "type": "select",
          "id": "content_type",
          "label": "t:sections.marquee_section.blocks.text_logo.settings.content_type.label",
          "options": [
            {
              "value": "text",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.content_type.option_1.label"
            },
            {
              "value": "logo",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.content_type.option_2.label"
            },
            {
              "value": "both",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.content_type.option_3.label"
            }
          ],
          "default": "text"
        },
        {
          "type": "paragraph",
          "content": "t:sections.marquee_section.blocks.text_logo.settings.paragraph.content"
        },
        {
          "type": "text",
          "id": "text",
          "label": "t:sections.marquee_section.blocks.text_logo.settings.marquee_text.label",
          "default": "t:sections.marquee_section.blocks.text_logo.settings.marquee_text.default"
        },
        {
          "type": "range",
          "id": "text_size",
          "min": 12,
          "max": 50,
          "step": 1,
          "unit": "px",
          "label": "t:sections.marquee_section.blocks.text_logo.settings.text_size.label",
          "default": 16
        },
        {
          "type": "image_picker",
          "id": "logo_image",
          "label": "t:sections.marquee_section.blocks.text_logo.settings.logo_image.label"
        },
        {
          "type": "url",
          "id": "logo_link",
          "label": "t:sections.marquee_section.blocks.text_logo.settings.logo_link.label"
        },
        {
          "type": "select",
          "id": "icon",
          "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.label",
          "options": [
            {
              "value": "none",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_1.label"
            },
            {
              "value": "t-shirt",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_2.label"
            },
            {
              "value": "heart",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_3.label"
            },
            {
              "value": "phone",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_4.label"
            },
            {
              "value": "smile",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_5.label"
            },
            {
              "value": "thumbs-up",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_6.label"
            },
            {
              "value": "box",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_7.label"
            },
            {
              "value": "check_mark",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_8.label"
            },
            {
              "value": "eye",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_9.label"
            },
            {
              "value": "fire",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_10.label"
            },
            {
              "value": "iron",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_11.label"
            },
            {
              "value": "map_pin",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_12.label"
            },
            {
              "value": "nut_free",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_13.label"
            },
            {
              "value": "price_tag",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_14.label"
            },
            {
              "value": "question_mark",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_15.label"
            },
            {
              "value": "star",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_16.label"
            },
            {
              "value": "stopwatch",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_17.label"
            },
            {
              "value": "pen",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_18.label"
            },
            {
              "value": "gift",
              "label": "t:sections.marquee_section.blocks.text_logo.settings.icon.option_19.label"
            }
          ],
          "default": "heart"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.marquee_section.presets.name",
      "blocks": [
        {
          "type": "content"
        },
            {
          "type": "content"
        }
      ]
    }
  ]
}
{% endschema %}
<script>
    $(window).on('load', function() {
    $(window).on('scroll', function() {
      $('.animations').each(function() {
        if ($(this).offset().top < $(window).scrollTop() + $(window).height()) {
          $(this).addClass('active');
        }
      });
    });

    $(window).trigger('scroll');
  });
   $(document).ready(function () {
      var scrollDirection = '{{ section.settings.scroll_direction }}' || 'left';
      var scrollSpeed = parseInt('{{ section.settings.scroll_speed }}') || 30000;
      var pauseOnHover = {{ section.settings.pause_on_hover | json }} || true;

  var itemsCount = $('.marquee-infinte{{ section.id }}').children().length;

  if (itemsCount == 1) {
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
  }else if (itemsCount < 5) {
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
  }else{
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
    $('.marquee-infinte{{ section.id }}').append($('.marquee-infinte{{ section.id }}').children().clone());
  }

  // Initialize the marquee
  $('.marquee-infinte{{ section.id }}').marquee({
      direction: scrollDirection,
      duration: scrollSpeed,
      gap: 20,
      delayBeforeStart: 0,
      duplicated: true,
      pauseOnHover: pauseOnHover,
      startVisible: true
  });

    });
</script>
